# 画像認証チェック機能のON・OFF設定表示修正

## 問題の概要

問題編集ページ（`ProblemEditPage`）で画像認証チェック機能のON・OFF設定が表示されていない問題がありました。

## 確認結果

コードを確認したところ、チェックページ設定セクションは実装されています（327-408行目）：

- ✅ セクションヘッダー「チェックページ設定」が存在
- ✅ `SwitchListTile`で「認証チェックを有効にする」スイッチが存在
- ✅ `_requiresCheck`の状態管理が実装されている

## 実施した修正

### 1. `_loadProblemData()`メソッドの修正

`initState`で呼ばれる`_loadProblemData()`メソッドで、データ読み込み後に`setState`を呼ぶように修正しました。これにより、初期化時にUIが確実に更新されます。

```dart
void _loadProblemData() {
  final problem = widget.initialProblem;
  if (problem != null) {
    // ... データ読み込み ...
    _requiresCheck = problem.requiresCheck;
    // setStateを呼んでUIを更新
    if (mounted) {
      setState(() {});
    }
  }
}
```

## チェックページ設定の表示位置

現在の表示順序：

1. 問題文
2. 答え
3. メディア
4. ヒント
5. **チェックページ設定** ← ここに表示される

## 表示内容

### チェックページ設定セクション

- **セクションヘッダー**: 「チェックページ設定」
- **スイッチ**: 「認証チェックを有効にする」
  - ONの場合: 以下の設定項目が表示される
    - 撮影すべき物体の説明（テキストフィールド）
    - 見本画像URL（テキストフィールド + アップロードボタン）
    - 見本画像プレビュー（画像が設定されている場合）
  - OFFの場合: 「認証チェックがオフの場合、正解後は画像認証なしで次の問題へ遷移します」という説明文が表示される

## 確認事項

- [x] チェックページ設定セクションが存在する
- [x] `_requiresCheck`の初期化が正しく行われている
- [x] `setState`でUIが更新されるように修正
- [ ] 実際の画面で表示されているか確認が必要

## トラブルシューティング

もし画面で表示されない場合：

1. **スクロールして確認**
   - チェックページ設定は画面の下の方に配置されています
   - 画面を下にスクロールして確認してください

2. **初期化の確認**
   - `_requiresCheck`のデフォルト値は`true`です
   - 既存の問題を編集する場合、`problem.requiresCheck`の値が読み込まれます

3. **デバッグ方法**
   - `_requiresCheck`の値をログ出力して確認
   - `SwitchListTile`の`value`プロパティが正しく設定されているか確認

## 関連ファイル

- `lib/lib/pages/problem_edit_page.dart` - 修正済み
- `lib/lib/models/problem.dart` - `requiresCheck`フィールドの定義




